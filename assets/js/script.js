// DOM selector variables
const starButtonEl = document.getElementById('start');
const nextButtonEl = document.getElementById('next')
const startPageEl = document.getElementById('start-screen');
const questionPageEl = document.getElementById('question-container');
const questionEl = document.getElementById('question');
const answerChoicesEl = document.getElementById('answer-choices');
const countdownEl = document.getElementById('shot-clock');
const timerEl = document.getElementById('timer');

// general variables
let randomQuestions; 
let questionIndex;
let startingTimerSec = 300;

// functions
function startQuiz() {
    startPageEl.classList.add('not-visible');
    starButtonEl.classList.add('not-visible');
    countdownEl.classList.remove('not-visible');
    questionPageEl.classList.remove('not-visible');
    nextButtonEl.classList.remove('not-visible');
    randomQuestions = questions.sort(() => Math.random() -0.5 ); // investigate changing random method
    setCountdownTimer();
    questionIndex = 0;
    setNextQuestion();
}

function setCountdownTimer() {
    var timerInterval = setInterval(function() {
    secondsLeft--;
    timeEl.textContent = secondsLeft + " seconds left till colorsplosion.";

    if(secondsLeft === 0) {
      clearTime(timerInterval);
      gameOverScreen();
    }

  }, 1000);
}

// clear out timer values
function clearTime() {

}

// Show final screen with timer and high score input.
function gameOverScreen() {
    
}

function clearCard(){
    nextButtonEl.classList.add('not-visible');
    while (answerChoicesEl.firstChild) {
        answerChoicesEl.removeChild(answerChoicesEl.firstChild);
    }
}

function viewQuestion(question) {
    questionEl.innerText = question.question;
    question.answers.forEach(answer => {
        const button = document.createElement('button');
        button.innerText = answer.option;
        button.classList.add('answer-choice');
         // check if correct
         if(answer.correct){
            button.dataset.correct = answer.correct;
         }
         button.addEventListener('click', selectAnswer);
         answerChoicesEl.appendChild(button);
    })
}

function setNextQuestion(){
    clearCard();
    viewQuestion(randomQuestions[questionIndex]);
}

function selectAnswer() {
    let choiceArr = Array.from(answerChoicesEl.children);
    choiceArr.forEach(button => {
        setClass(button, button.dataset.correct);
    });
    if (randomQuestions.length > questionIndex +1) {
        nextButtonEl.classList.remove('not-visible');
    }
}

function setClass(buttonEl, correct) {
    clearClassStatus(buttonEl);
    if (correct) {
        buttonEl.classList.add('correct')
    } else {
        buttonEl.classList.add('wrong')
    }
}

function clearClassStatus(eL) {
    console.log("Clear Class: " + eL);
    eL.classList.remove('correct');
    eL.classList.remove('wrong');
}

function nextQuestion() {
    questionIndex++;
    setNextQuestion();
}

// Event listener for clicking start button
starButtonEl.addEventListener('click', startQuiz);
nextButtonEl.addEventListener('click', nextQuestion);

// example questions were generated by chatGPT from a prompt I entered, cited in README
const questions = [
    {
        question: "What does 'HTML' stand for?",
        answers: [
            { option: 'Hyper Text Markup Language', correct: true },
            { option: 'Hyperlink and Text Markup Language', correct: false },
            { option: 'Highly Typed Markup Language', correct: false },
            { option: 'Home Tool Markup Language', correct: false },
        ],
    },
    {
        question: "Which keyword is used to declare a variable in JavaScript?",
        answers: [
            { option: 'var', correct: true },
            { option: 'let', correct: false },
            { option: 'const', correct: false },
            { option: 'variable', correct: false },
        ],
    },
    {
        question: "What is the result of '5 + '5' in JavaScript?",
        answers: [
            { option: '10', correct: false },
            { option: '55', correct: true },
            { option: '5 + 5', correct: false },
            { option: 'Error', correct: false },
        ],
    },
    {
        question: "Which function is used to print something to the console in JavaScript?",
        answers: [
            { option: 'print()', correct: false },
            { option: 'log()', correct: false },
            { option: 'console.log()', correct: true },
            { option: 'display()', correct: false },
        ],
    },
    {
        question: "What is the value of 'null' in JavaScript?",
        answers: [
            { option: '0', correct: false },
            { option: 'undefined', correct: false },
            { option: 'false', correct: false },
            { option: 'null', correct: true },
        ],
    },
    {
        question: "What does 'NaN' stand for in JavaScript?",
        answers: [
            { option: 'Not a Number', correct: true },
            { option: 'No Available Number', correct: false },
            { option: 'Notation of Number', correct: false },
            { option: 'No Action Needed', correct: false },
        ],
    },
    {
        question: "Which loop is used for iterating over the properties of an object?",
        answers: [
            { option: 'for loop', correct: false },
            { option: 'while loop', correct: false },
            { option: 'for...in loop', correct: true },
            { option: 'do...while loop', correct: false },
        ],
    },
    {
        question: "What is the result of '3 === '3' in JavaScript?",
        answers: [
            { option: 'true', correct: false },
            { option: 'false', correct: true },
            { option: 'undefined', correct: false },
            { option: 'null', correct: false },
        ],
    },
    {
        question: "Which operator is used to combine two or more strings in JavaScript?",
        answers: [
            { option: '+', correct: true },
            { option: '-', correct: false },
            { option: '*', correct: false },
            { option: '/', correct: false },
        ],
    },
    {
        question: "What is the correct way to write a comment in JavaScript?",
        answers: [
            { option: '// This is a comment', correct: true },
            { option: '<!-- This is a comment -->', correct: false },
            { option: '/* This is a comment */', correct: false },
            { option: '# This is a comment', correct: false },
        ],
    },
];
